<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MySQL 基础篇 | 猫的树</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="猫的树个人笔记">
    <meta name="referrer" content="no-referrer">
    
    <link rel="preload" href="/document/assets/css/0.styles.3be45a55.css" as="style"><link rel="preload" href="/document/assets/js/app.407b5965.js" as="script"><link rel="preload" href="/document/assets/js/2.3dc1b8de.js" as="script"><link rel="preload" href="/document/assets/js/1.54be531d.js" as="script"><link rel="preload" href="/document/assets/js/23.cbb9b3bb.js" as="script"><link rel="prefetch" href="/document/assets/js/10.563984b0.js"><link rel="prefetch" href="/document/assets/js/11.c389195a.js"><link rel="prefetch" href="/document/assets/js/12.81539b0f.js"><link rel="prefetch" href="/document/assets/js/13.4d4410c4.js"><link rel="prefetch" href="/document/assets/js/14.37ef2a72.js"><link rel="prefetch" href="/document/assets/js/15.5542c093.js"><link rel="prefetch" href="/document/assets/js/16.d48fd1ce.js"><link rel="prefetch" href="/document/assets/js/17.bd8d538c.js"><link rel="prefetch" href="/document/assets/js/18.6d3b94c1.js"><link rel="prefetch" href="/document/assets/js/19.eb35cfee.js"><link rel="prefetch" href="/document/assets/js/20.7d8a0e52.js"><link rel="prefetch" href="/document/assets/js/21.db1b5d88.js"><link rel="prefetch" href="/document/assets/js/22.ac872159.js"><link rel="prefetch" href="/document/assets/js/24.3bad736d.js"><link rel="prefetch" href="/document/assets/js/25.469b1659.js"><link rel="prefetch" href="/document/assets/js/3.5322f14a.js"><link rel="prefetch" href="/document/assets/js/4.84e1e480.js"><link rel="prefetch" href="/document/assets/js/5.f0541060.js"><link rel="prefetch" href="/document/assets/js/6.dfb06aa0.js"><link rel="prefetch" href="/document/assets/js/7.7551a9fb.js"><link rel="prefetch" href="/document/assets/js/vendors~docsearch.5e19b665.js">
    <link rel="stylesheet" href="/document/assets/css/0.styles.3be45a55.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/document/" class="home-link router-link-active"><img src="/document/assets/img/logo2.jpg" alt="猫的树" class="logo"> <span class="site-name can-hide">猫的树</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/document/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          MySQL
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/document/database/MySQL基础篇.html" class="nav-link">
  MySQL基础篇
</a></li><li class="dropdown-subitem"><a href="/document/database/MySQL进阶篇.html" class="nav-link">
  MySQL进阶篇
</a></li></ul></li><li class="dropdown-item"><h4>
          Group2
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/document/" class="nav-link">
  Home
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><span class="title">Node</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node" class="mobile-dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          nodejs
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/document/node/node.html" class="nav-link">
  node
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/cattreeo/document" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/document/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          MySQL
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/document/database/MySQL基础篇.html" class="nav-link">
  MySQL基础篇
</a></li><li class="dropdown-subitem"><a href="/document/database/MySQL进阶篇.html" class="nav-link">
  MySQL进阶篇
</a></li></ul></li><li class="dropdown-item"><h4>
          Group2
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/document/" class="nav-link">
  Home
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><span class="title">Node</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node" class="mobile-dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          nodejs
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/document/node/node.html" class="nav-link">
  node
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/cattreeo/document" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MySQL 基础篇</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#jdbc-mysql8-配置" class="sidebar-link">JDBC-MySQL8 配置</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#数据库的创建和增删改查" class="sidebar-link">数据库的创建和增删改查</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#操作表-user" class="sidebar-link">操作表 user</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#_1-数据类型" class="sidebar-link">1.数据类型</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#_2-创建表" class="sidebar-link">2.创建表</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#_3-查询" class="sidebar-link">3.查询</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#_4-插入" class="sidebar-link">4.插入</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#_5-删除" class="sidebar-link">5.删除</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#_6-修改" class="sidebar-link">6.修改</a></li></ul></li><li><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#ddl" class="sidebar-link">DDL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#数据库操作" class="sidebar-link">数据库操作</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#表操作" class="sidebar-link">表操作</a></li></ul></li><li><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#dml" class="sidebar-link">DML</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#添加数据" class="sidebar-link">添加数据</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#修改数据" class="sidebar-link">修改数据</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#删除数据" class="sidebar-link">删除数据</a></li></ul></li><li><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#dql" class="sidebar-link">DQL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#基本语法" class="sidebar-link">基本语法</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#基本查询" class="sidebar-link">基本查询</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#条件查询" class="sidebar-link">条件查询</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#聚合函数" class="sidebar-link">聚合函数</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#分组查询" class="sidebar-link">分组查询</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#排序查询" class="sidebar-link">排序查询</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#分页查询" class="sidebar-link">分页查询</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#执行顺序" class="sidebar-link">执行顺序</a></li></ul></li><li><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#dcl" class="sidebar-link">DCL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#管理用户" class="sidebar-link">管理用户</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#权限控制" class="sidebar-link">权限控制</a></li></ul></li><li><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#函数" class="sidebar-link">函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#处理-null-值-coalesce-函数" class="sidebar-link">处理 NULL 值（coalesce 函数）</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#字符串函数" class="sidebar-link">字符串函数</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#数值函数" class="sidebar-link">数值函数</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#日期函数" class="sidebar-link">日期函数</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#流程函数" class="sidebar-link">流程函数</a></li></ul></li><li><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#约束" class="sidebar-link">约束</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#概述" class="sidebar-link">概述</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#约束演示" class="sidebar-link">约束演示</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#外键约束" class="sidebar-link">外键约束</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#删除-更新行为" class="sidebar-link">删除/更新行为</a></li></ul></li><li><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#多表联查" class="sidebar-link">多表联查</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#分类" class="sidebar-link">分类</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#内连接" class="sidebar-link">内连接</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#外连接" class="sidebar-link">外连接</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#自连接" class="sidebar-link">自连接</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#子查询" class="sidebar-link">子查询</a></li></ul></li><li><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#事务" class="sidebar-link">事务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#事务简介" class="sidebar-link">事务简介</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#事务操作" class="sidebar-link">事务操作</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#事务四大特性" class="sidebar-link">事务四大特性</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#并发事务问题" class="sidebar-link">并发事务问题</a></li><li class="sidebar-sub-header"><a href="/document/database/MySQL%E5%9F%BA%E7%A1%80%E7%AF%87.html#事务隔离级别" class="sidebar-link">事务隔离级别</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mysql-基础篇"><a href="#mysql-基础篇" class="header-anchor">#</a> MySQL 基础篇</h1> <h2 id="jdbc-mysql8-配置"><a href="#jdbc-mysql8-配置" class="header-anchor">#</a> JDBC-MySQL8 配置</h2> <ol><li>引用外部库  mysql-connector-java-8.0.版本的 jar</li> <li>jdbc 驱动类：com.mysql.jdbc.Driver   改成 com.mysql.cj.jdbc.Driver</li> <li>jdbcUrl：jdbc:mysql://{ip}:{port}/{db}?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=UTC&amp;rewriteBatchedStatements=true</li></ol> <h2 id="数据库的创建和增删改查"><a href="#数据库的创建和增删改查" class="header-anchor">#</a> 数据库的创建和增删改查</h2> <h3 id="操作表-user"><a href="#操作表-user" class="header-anchor">#</a> 操作表 user</h3> <table><thead><tr><th>id</th> <th>username</th> <th>password</th></tr></thead> <tbody><tr><td>1</td> <td>user1</td> <td>123</td></tr> <tr><td>2</td> <td>user2</td> <td>123</td></tr> <tr><td>3</td> <td>user3</td> <td>123</td></tr></tbody></table> <h3 id="_1-数据类型"><a href="#_1-数据类型" class="header-anchor">#</a> 1.数据类型</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">char</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>			长度为n的字符型
<span class="token keyword">varchar</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>		长度为n的变长字符型
number<span class="token punctuation">(</span>n<span class="token punctuation">)</span>		长度为n的数字型
<span class="token keyword">int</span>				长整型
<span class="token keyword">smallint</span>		短整型
<span class="token keyword">bigint</span>			大整型
flaot<span class="token punctuation">(</span>n<span class="token punctuation">)</span>		精度至少为n位数字的浮点型
<span class="token keyword">date</span>			日期，格式为YYYY<span class="token operator">-</span>MM<span class="token operator">-</span>DD
<span class="token keyword">time</span>			时间，格式为HH:MM:SS
</code></pre></div><h3 id="_2-创建表"><a href="#_2-创建表" class="header-anchor">#</a> 2.创建表</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">user</span>
<span class="token punctuation">(</span>
  id <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
  username <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  password <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">not</span> <span class="token boolean">null</span> <span class="token comment">-- 非空</span>
<span class="token keyword">primary</span> <span class="token keyword">key</span>  <span class="token comment">-- 主键</span>
<span class="token keyword">auto_increment</span>  <span class="token comment">-- 自增长</span>
</code></pre></div><h3 id="_3-查询"><a href="#_3-查询" class="header-anchor">#</a> 3.查询</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> 表名  <span class="token comment">-- 查询全部</span>
<span class="token keyword">select</span> 列名<span class="token punctuation">[</span><span class="token punctuation">,</span>列名<span class="token punctuation">,</span>列名<span class="token punctuation">,</span>···<span class="token punctuation">,</span>列名<span class="token punctuation">]</span> <span class="token keyword">from</span> 表名  <span class="token comment">-- 查找一列数据</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> 表名 <span class="token keyword">where</span> 列名<span class="token operator">=</span>值  <span class="token comment">-- 按条件查找</span>
<span class="token keyword">select</span> 列名<span class="token punctuation">[</span><span class="token punctuation">,</span>列名<span class="token punctuation">,</span>列名<span class="token punctuation">,</span>···<span class="token punctuation">,</span>列名<span class="token punctuation">]</span> <span class="token keyword">from</span> 表名 <span class="token keyword">where</span> 列名<span class="token operator">=</span>值  <span class="token comment">-- 按条件查找查找一列数据</span>

eg<span class="token punctuation">.</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span>
	<span class="token keyword">select</span> username <span class="token keyword">from</span> <span class="token keyword">user</span>
	<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span>
	<span class="token keyword">select</span> username <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span>
</code></pre></div><h3 id="_4-插入"><a href="#_4-插入" class="header-anchor">#</a> 4.插入</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span>  表名 <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span>···<span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>  <span class="token comment">-- 按顺序插入</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span>  表名<span class="token punctuation">(</span>列名<span class="token punctuation">,</span>列名<span class="token punctuation">,</span>···<span class="token punctuation">,</span>列名<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span>···<span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>  <span class="token comment">-- 按列插入</span>

eq<span class="token punctuation">.</span> <span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">user</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'user'</span><span class="token punctuation">,</span><span class="token string">'123'</span><span class="token punctuation">)</span>
	<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">user</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">,</span><span class="token string">'123'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_5-删除"><a href="#_5-删除" class="header-anchor">#</a> 5.删除</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">delete</span> <span class="token keyword">from</span> 表名 <span class="token keyword">where</span> 列名<span class="token operator">=</span>值
<span class="token keyword">delete</span> <span class="token keyword">from</span> 表名 <span class="token keyword">where</span> 列名 <span class="token operator">in</span> <span class="token punctuation">(</span>值<span class="token number">1</span><span class="token punctuation">,</span>值<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>值n<span class="token punctuation">)</span>

eq<span class="token punctuation">.</span> <span class="token keyword">delete</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span>
	<span class="token keyword">delete</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_6-修改"><a href="#_6-修改" class="header-anchor">#</a> 6.修改</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">update</span> 表名 <span class="token keyword">set</span> 列名<span class="token number">1</span><span class="token operator">=</span>值<span class="token number">1</span><span class="token punctuation">[</span><span class="token punctuation">,</span> 列名<span class="token number">2</span><span class="token operator">=</span>值<span class="token number">2</span><span class="token punctuation">,</span> ··· <span class="token punctuation">,</span>列名n<span class="token operator">=</span>值n<span class="token punctuation">]</span> <span class="token keyword">where</span> 列名<span class="token operator">=</span>值

eq<span class="token punctuation">.</span> <span class="token keyword">update</span> <span class="token keyword">user</span> <span class="token keyword">set</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'user0'</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span>
</code></pre></div><h2 id="ddl"><a href="#ddl" class="header-anchor">#</a> DDL</h2> <p>Data Definition Language，数据定义语言，用来定义数据库对象(数据库，表，字段) 。</p> <h3 id="数据库操作"><a href="#数据库操作" class="header-anchor">#</a> 数据库操作</h3> <ol><li>查询所有数据库</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 查询所有数据库</span>
<span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>查询当前数据库</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 查询当前数据库</span>
selectdatabase<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>创建数据库</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 创建数据库</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token punctuation">[</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> <span class="token punctuation">]</span> 数据库名 <span class="token punctuation">[</span> <span class="token keyword">default</span> <span class="token keyword">charset</span> 字符集 <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token keyword">collate</span> 排序规则 <span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><ol start="4"><li>删除数据库</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 删除数据库</span>
<span class="token keyword">drop</span> <span class="token keyword">database</span> <span class="token punctuation">[</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> <span class="token punctuation">]</span> 数据库名<span class="token punctuation">;</span>
</code></pre></div><ol start="5"><li>切换数据库</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 切换数据库</span>
<span class="token keyword">use</span> 数据库名<span class="token punctuation">;</span>
</code></pre></div><h3 id="表操作"><a href="#表操作" class="header-anchor">#</a> 表操作</h3> <ol><li>查询当前数据库所有表</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 查询当前数据库所有表</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>查看指定表结构</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 查看指定表结构</span>
<span class="token keyword">desc</span> 表名<span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>查询指定表的建表语句</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">--查询指定表的建表语句</span>
<span class="token keyword">show</span> <span class="token keyword">create</span> <span class="token keyword">table</span> 表名<span class="token punctuation">;</span>
</code></pre></div><ol start="4"><li>创建表结构</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 创建表结构</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> 表名<span class="token punctuation">(</span>
  字段<span class="token number">1</span> 字段<span class="token number">1</span>类型 <span class="token punctuation">[</span> <span class="token keyword">comment</span> 字段<span class="token number">1</span>注释 <span class="token punctuation">]</span><span class="token punctuation">,</span>
  字段<span class="token number">2</span> 字段<span class="token number">2</span>类型 <span class="token punctuation">[</span> <span class="token keyword">comment</span> 字段<span class="token number">2</span>注释 <span class="token punctuation">]</span><span class="token punctuation">,</span>
  字段<span class="token number">3</span> 字段<span class="token number">3</span>类型 <span class="token punctuation">[</span> <span class="token keyword">comment</span> 字段<span class="token number">3</span>注释 <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  字段n 字段n类型 <span class="token punctuation">[</span> <span class="token keyword">comment</span> 字段n注释 <span class="token punctuation">]</span>
<span class="token punctuation">)</span> <span class="token punctuation">[</span> <span class="token keyword">comment</span> 表注释 <span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="表操作-修改"><a href="#表操作-修改" class="header-anchor">#</a> 表操作-修改</h4> <ol><li>添加字段</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 添加字段</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名 <span class="token keyword">add</span> 字段名 类型<span class="token punctuation">(</span>长度<span class="token punctuation">)</span> <span class="token punctuation">[</span> <span class="token keyword">comment</span> 注释 <span class="token punctuation">]</span> <span class="token punctuation">[</span> 约束 <span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>修改数据类型</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 修改数据类型</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名 <span class="token keyword">modify</span> 字段名 新数据类型<span class="token punctuation">(</span>长度<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>修改字段名和字段类型</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 修改字段名和字段类型</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名 change 旧字段名 新字段名 类型<span class="token punctuation">(</span>长度<span class="token punctuation">)</span> <span class="token punctuation">[</span> <span class="token keyword">comment</span> 注释 <span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><ol start="4"><li>删除字段</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 删除字段</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名 <span class="token keyword">drop</span> 字段名<span class="token punctuation">;</span>
</code></pre></div><ol start="5"><li>修改表名</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 修改表名</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名 <span class="token keyword">rename</span> <span class="token keyword">to</span> 新表名<span class="token punctuation">;</span>
</code></pre></div><h4 id="表操作-删除"><a href="#表操作-删除" class="header-anchor">#</a> 表操作-删除</h4> <ol><li>删除表</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 删除表</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token punctuation">[</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> <span class="token punctuation">]</span> 表名<span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>删除指定表，并重新创建表</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 删除指定表，并重新创建表</span>
<span class="token keyword">truncate</span> <span class="token keyword">table</span> 表名<span class="token punctuation">;</span>
</code></pre></div><h2 id="dml"><a href="#dml" class="header-anchor">#</a> DML</h2> <p>DML 英文全称是 Data Manipulation Language(数据操作语言)，用来对数据库中表的数据记录进 行增、删、改操作。</p> <ul><li>添加数据（INSERT）</li> <li>修改数据（UPDATE）</li> <li>删除数据（DELETE）</li></ul> <h3 id="添加数据"><a href="#添加数据" class="header-anchor">#</a> 添加数据</h3> <p>给指定字段添加数据</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> 表名 <span class="token punctuation">(</span>字段名<span class="token number">1</span><span class="token punctuation">,</span> 字段名<span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span>值<span class="token number">1</span><span class="token punctuation">,</span> 值<span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>给全部字段添加数据</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> 表名 <span class="token keyword">values</span> <span class="token punctuation">(</span>值<span class="token number">1</span><span class="token punctuation">,</span> 值<span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>批量添加数据</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> 表名 <span class="token punctuation">(</span>字段名<span class="token number">1</span><span class="token punctuation">,</span> 字段名<span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword">values</span> <span class="token punctuation">(</span>值<span class="token number">1</span><span class="token punctuation">,</span> 值<span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>值<span class="token number">1</span><span class="token punctuation">,</span> 值<span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>值 <span class="token number">1</span><span class="token punctuation">,</span> 值<span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> 表名
<span class="token keyword">values</span> <span class="token punctuation">(</span>值<span class="token number">1</span><span class="token punctuation">,</span> 值<span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>值<span class="token number">1</span><span class="token punctuation">,</span> 值<span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>值<span class="token number">1</span><span class="token punctuation">,</span> 值<span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>注意事项:</p> <ul><li>插入数据时，指定的字段顺序需要与值的顺序是一一对应的。</li> <li>字符串和日期型数据应该包含在引号中。</li> <li>插入的数据大小，应该在字段的规定范围内。</li></ul></blockquote> <h3 id="修改数据"><a href="#修改数据" class="header-anchor">#</a> 修改数据</h3> <p>修改数据的具体语法为:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">update</span> 表名 <span class="token keyword">set</span> 字段名<span class="token number">1</span> <span class="token operator">=</span> 值<span class="token number">1</span> <span class="token punctuation">,</span> 字段名<span class="token number">2</span> <span class="token operator">=</span> 值<span class="token number">2</span> <span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">[</span> <span class="token keyword">where</span> 条件 <span class="token punctuation">]</span> <span class="token punctuation">;</span>
</code></pre></div><blockquote><p>注意事项:
修改语句的条件可以有，也可以没有，如果没有条件，则会修改整张表的所有数据。</p></blockquote> <h3 id="删除数据"><a href="#删除数据" class="header-anchor">#</a> 删除数据</h3> <p>删除数据的具体语法为：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">delete</span> <span class="token keyword">from</span> 表名 <span class="token punctuation">[</span> <span class="token keyword">where</span> 条件 <span class="token punctuation">]</span>  <span class="token punctuation">;</span>
</code></pre></div><blockquote><p>注意事项:</p> <ul><li>DELETE 语句的条件可以有，也可以没有，如果没有条件，则会删除整张表的所有数 据。</li> <li>DELETE 语句不能删除某一个字段的值(可以使用 UPDATE，将该字段值置为 NULL 即 可)。</li> <li>当进行删除全部数据操作时，datagrip 会提示我们，询问是否确认删除，我们直接点击 Execute 即可。</li></ul></blockquote> <h2 id="dql"><a href="#dql" class="header-anchor">#</a> DQL</h2> <p>DQL 英文全称是 Data Query Language(数据查询语言)，数据查询语言，用来查询数据库中表的记录。</p> <p>在一个正常的业务系统中，查询操作的频次是要远高于增删改的，当我们去访问企业官网、电商网站， 在这些网站中我们所看到的数据，实际都是需要从数据库中查询并展示的。而且在查询的过程中，可能 还会涉及到条件、排序、分页等操作。</p> <h3 id="基本语法"><a href="#基本语法" class="header-anchor">#</a> 基本语法</h3> <p>DQL 查询语句，语法结构如下：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span>
	字段列表
<span class="token keyword">from</span>
	表名列表
<span class="token keyword">where</span>
	条件列表
<span class="token keyword">group</span> <span class="token keyword">by</span>
	分组字段列表
<span class="token keyword">having</span>
	分组后条件列表
<span class="token keyword">order</span> <span class="token keyword">by</span>
	排序字段列表
<span class="token keyword">limit</span>
	分页参数
</code></pre></div><p>我们在讲解这部分内容的时候，会将上面的完整语法进行拆分，分为以下几个部分：</p> <ul><li>基本查询（不带任何条件）</li> <li>条件查询（WHERE）</li> <li>聚合函数（count、max、min、avg、sum）</li> <li>分组查询（group by）</li> <li>排序查询（order by）</li> <li>分页查询（limit）</li></ul> <h3 id="基本查询"><a href="#基本查询" class="header-anchor">#</a> 基本查询</h3> <p>查询多个字段</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> 字段<span class="token number">1</span><span class="token punctuation">,</span> 字段<span class="token number">2</span><span class="token punctuation">,</span> 字段<span class="token number">3</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">from</span> 表名<span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> 表名<span class="token punctuation">;</span>
</code></pre></div><p>字段设置别名</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> 字段<span class="token number">1</span> <span class="token punctuation">[</span> <span class="token keyword">as</span> 别名<span class="token number">1</span> <span class="token punctuation">]</span> <span class="token punctuation">,</span> 字段<span class="token number">2</span> <span class="token punctuation">[</span> <span class="token keyword">as</span> 别名<span class="token number">2</span> <span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">from</span> 表名<span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> 字段<span class="token number">1</span> <span class="token punctuation">[</span> 别名<span class="token number">1</span> <span class="token punctuation">]</span> <span class="token punctuation">,</span> 字段<span class="token number">2</span> <span class="token punctuation">[</span> 别名<span class="token number">2</span> <span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">from</span> 表名<span class="token punctuation">;</span>
</code></pre></div><p>去除重复记录</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">distinct</span> 字段列表 <span class="token keyword">from</span> 表名<span class="token punctuation">;</span>
</code></pre></div><h3 id="条件查询"><a href="#条件查询" class="header-anchor">#</a> 条件查询</h3> <p>语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> 字段列表 <span class="token keyword">from</span> 表名 <span class="token keyword">where</span> 条件列表<span class="token punctuation">;</span>
</code></pre></div><p>条件</p> <table><thead><tr><th><strong>比较运算符</strong></th> <th><strong>功能</strong></th></tr></thead> <tbody><tr><td>&gt;</td> <td>大于</td></tr> <tr><td>&gt;=</td> <td>大于等于</td></tr> <tr><td>&lt;</td> <td>小于</td></tr> <tr><td>&lt;=</td> <td>小于等于</td></tr> <tr><td>=</td> <td>等于</td></tr> <tr><td>&lt;&gt; 或 !=</td> <td>不等于</td></tr> <tr><td>between ... and ...</td> <td>在某个范围之内（含最大值、最小值）</td></tr> <tr><td>in ( ... )</td> <td>在 in 之后的列表中的值，多选一</td></tr> <tr><td>like 占位符</td> <td>模糊匹配（_匹配单个字符，%匹配任意个字符）</td></tr> <tr><td>is null</td> <td>是 NULL</td></tr></tbody></table> <p>常用的逻辑运算符：</p> <table><thead><tr><th><strong>逻辑运算符</strong></th> <th><strong>功能</strong></th></tr></thead> <tbody><tr><td>and 或 &amp;&amp;</td> <td>并且</td></tr> <tr><td>or 或 ||</td> <td>或者</td></tr> <tr><td>not 或 !</td> <td>非，不是</td></tr></tbody></table> <h3 id="聚合函数"><a href="#聚合函数" class="header-anchor">#</a> 聚合函数</h3> <p>将一列数据作为一个整体，进行纵向计算 。</p> <p>常见的聚合函数</p> <table><thead><tr><th><strong>函数</strong></th> <th><strong>功能</strong></th></tr></thead> <tbody><tr><td>count</td> <td>统计数量</td></tr> <tr><td>max</td> <td>最大值</td></tr> <tr><td>min</td> <td>最小值</td></tr> <tr><td>avg</td> <td>平均值</td></tr> <tr><td>sum</td> <td>求和</td></tr></tbody></table> <p>语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> 聚合函数<span class="token punctuation">(</span>字段列表<span class="token punctuation">)</span> <span class="token keyword">from</span> 表名<span class="token punctuation">;</span>
</code></pre></div><h3 id="分组查询"><a href="#分组查询" class="header-anchor">#</a> 分组查询</h3> <p>语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> 表名
<span class="token punctuation">[</span> <span class="token keyword">where</span> 条件 <span class="token punctuation">]</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> 分组字段名
<span class="token punctuation">[</span> <span class="token keyword">having</span> 分组后过滤条件 <span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>where 与 having 区别</p> <ul><li>执行时机不同：where 是分组之前进行过滤，不满足 where 条件，不参与分组；而 having 是分组 之后对结果进行过滤。</li> <li>判断条件不同：where 不能对聚合函数进行判断，而 having 可以。</li></ul> <blockquote><p>注意事项:</p> <ul><li>分组之后，查询的字段一般为聚合函数和分组字段，查询其他字段无任何意义。</li> <li>执行顺序: where &gt; 聚合函数 &gt; having 。</li> <li>支持多字段分组, 具体语法为 : group by columnA,columnB</li></ul></blockquote> <h3 id="排序查询"><a href="#排序查询" class="header-anchor">#</a> 排序查询</h3> <p>语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表名
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 字段<span class="token number">1</span> 排序方式<span class="token number">1</span> <span class="token punctuation">,</span> 字段<span class="token number">2</span> 排序方式<span class="token number">2</span><span class="token punctuation">;</span>
</code></pre></div><p>排序方式</p> <ul><li>ASC : 升序(默认值)</li> <li>DESC: 降序</li></ul> <blockquote><p>注意事项：</p> <ul><li>如果是升序, 可以不指定排序方式 ASC ;</li> <li>如果是多字段排序，当第一个字段值相同时，才会根据第二个字段进行排序</li></ul></blockquote> <h3 id="分页查询"><a href="#分页查询" class="header-anchor">#</a> 分页查询</h3> <p>语法</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> 字段列表 <span class="token keyword">from</span> 表名 <span class="token keyword">limit</span> 起始索引<span class="token punctuation">,</span> 查询记录数 <span class="token punctuation">;</span>
</code></pre></div><blockquote><p>注意事项:</p> <ul><li>起始索引从 0 开始，起始索引 = （查询页码 - 1）* 每页显示记录数。</li> <li>分页查询是数据库的方言，不同的数据库有不同的实现，MySQL 中是 LIMIT。</li> <li>如果查询的是第一页数据，起始索引可以省略，直接简写为 limit 10。</li></ul></blockquote> <h3 id="执行顺序"><a href="#执行顺序" class="header-anchor">#</a> 执行顺序</h3> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692772600059-59468e28-8c0c-4d02-a502-d6e66f0652c4.png#averageHue=%23fbf7e6&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=421&amp;id=u76cefe4d&amp;originHeight=421&amp;originWidth=934&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=116442&amp;status=done&amp;style=none&amp;taskId=u5259f70e-f01e-41c9-a023-16c594db82b&amp;title=&amp;width=934" alt="image.png"></p> <h2 id="dcl"><a href="#dcl" class="header-anchor">#</a> DCL</h2> <p>DCL 英文全称是 Data Control Language(数据控制语言)，用来管理数据库用户、控制数据库的访 问权限。</p> <h3 id="管理用户"><a href="#管理用户" class="header-anchor">#</a> 管理用户</h3> <p>查询用户</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre></div><p>查询结果如下：
<img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692772783582-37ee5548-7a87-4546-84fa-639fb53874ba.png#averageHue=%23f9f8f7&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=116&amp;id=u79a0e9ad&amp;originHeight=116&amp;originWidth=915&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=31389&amp;status=done&amp;style=none&amp;taskId=ub1f525a6-9676-429c-8c77-48510d8b305&amp;title=&amp;width=915" alt="image.png">
其中 Host 代表当前用户访问的主机, 如果为 localhost, 仅代表只能够在当前本机访问，是不可以 远程访问的。 User 代表的是访问该数据库的用户名。在 MySQL 中需要通过 Host 和 User 来唯一标识一 个用户。</p> <p>创建用户</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">user</span> <span class="token string">'用户名'</span><span class="token variable">@'主机名'</span> identified <span class="token keyword">by</span> <span class="token string">'密码'</span><span class="token punctuation">;</span>
</code></pre></div><p>修改用户密码</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">user</span> <span class="token string">'用户名'</span><span class="token variable">@'主机名'</span>
identified <span class="token keyword">with</span> mysql_native_password
<span class="token keyword">by</span> <span class="token string">'新密码'</span><span class="token punctuation">;</span>
</code></pre></div><p>删除用户</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">user</span> <span class="token string">'用户名'</span><span class="token variable">@'主机名'</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>注意事项:</p> <ul><li>在 MySQL 中需要通过用户名@主机名的方式，来唯一标识一个用户。</li> <li>主机名可以使用 % 通配。</li> <li>这类 SQL 开发人员操作的比较少，主要是 DBA（ Database Administrator 数据库 管理员）使用。</li></ul></blockquote> <h3 id="权限控制"><a href="#权限控制" class="header-anchor">#</a> 权限控制</h3> <p>MySQL 中定义了很多种权限，但是常用的就以下几种：</p> <table><thead><tr><th><strong>权限</strong></th> <th><strong>说明</strong></th></tr></thead> <tbody><tr><td>all, all privileges</td> <td>所有权限</td></tr> <tr><td>select</td> <td>查询权限</td></tr> <tr><td>insert</td> <td>插入数据</td></tr> <tr><td>update</td> <td>修改数据</td></tr> <tr><td>delete</td> <td>删除数据</td></tr> <tr><td>alter</td> <td>修改表</td></tr> <tr><td>drop</td> <td>删除数据库/表/视图</td></tr> <tr><td>create</td> <td>创建数据库/表</td></tr></tbody></table> <p>上述只是简单罗列了常见的几种权限描述，其他权限描述及含义，可以直接参考<a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>查询权限</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">show</span> grants <span class="token keyword">for</span> <span class="token string">'用户名'</span><span class="token variable">@'主机名'</span> <span class="token punctuation">;</span>
</code></pre></div><p>授予权限</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">grant</span> 权限列表 <span class="token keyword">on</span> 数据库名<span class="token punctuation">.</span>表名 <span class="token keyword">to</span> <span class="token string">'用户名'</span><span class="token variable">@'主机名'</span>
</code></pre></div><p>撤销权限</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">revoke</span> 权限列表 <span class="token keyword">on</span> 数据库名<span class="token punctuation">.</span>表名 <span class="token keyword">from</span> <span class="token string">'用户名'</span><span class="token variable">@'主机名'</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>注意事项：</p> <ul><li>多个权限之间，使用逗号分隔</li> <li>授权时， 数据库名和表名可以使用 * 进行通配，代表所有。</li></ul></blockquote> <h2 id="函数"><a href="#函数" class="header-anchor">#</a> 函数</h2> <p>函数 是指一段可以直接被另一段程序调用的程序或代码。 也就意味着，这一段程序或代码在 MySQL 中 已经给我们提供了，我们要做的就是在合适的业务场景调用对应的函数完成对应的业务需求即可。</p> <p>MySQL 中的函数主要分为以下四类： 字符串函数、数值函数、日期函数、流程函数。</p> <h3 id="处理-null-值-coalesce-函数"><a href="#处理-null-值-coalesce-函数" class="header-anchor">#</a> 处理 NULL 值（coalesce 函数）</h3> <table><thead><tr><th>coalesce</th> <th>coalesce 函数返回参数（列名）中第一个非 NULL 的字段值，注意不是为空''</th></tr></thead> <tbody></tbody></table> <p>soalesce</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 返回第一个非空字段值  如果都为NULL则返回NULL</span>
<span class="token keyword">select</span> <span class="token keyword">coalesce</span><span class="token punctuation">(</span>col1<span class="token punctuation">,</span> col2<span class="token punctuation">,</span> col3<span class="token punctuation">)</span> <span class="token keyword">from</span> 表名<span class="token punctuation">;</span>


<span class="token comment">-- 通过将最后一个参数设置为0 使得到的结果不会出现NULL</span>
<span class="token keyword">select</span> <span class="token keyword">coalesce</span><span class="token punctuation">(</span>字段<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">from</span> 表名<span class="token punctuation">;</span>

</code></pre></div><h3 id="字符串函数"><a href="#字符串函数" class="header-anchor">#</a> 字符串函数</h3> <p>MySQL 中内置了很多字符串函数，常用的几个如下 ：</p> <table><thead><tr><th><strong>函数</strong></th> <th><strong>功能</strong></th></tr></thead> <tbody><tr><td>CONCAT(S1,S2,...Sn)</td> <td>字符串拼接，将 S1，S2，... Sn 拼接成一个字符串</td></tr> <tr><td>LOWER(str)</td> <td>将字符串 str 全部转为小写</td></tr> <tr><td>UPPER(str)</td> <td>将字符串 str 全部转为大写</td></tr> <tr><td>LPAD(str,n,pad)</td> <td>左填充，用字符串 pad 对 str 的左边进行填充，达到 n 个字符 串长度</td></tr> <tr><td>RPAD(str,n,pad)</td> <td>右填充，用字符串 pad 对 str 的右边进行填充，达到 n 个字符 串长度</td></tr> <tr><td>TRIM(str)</td> <td>去掉字符串头部和尾部的空格</td></tr> <tr><td>SUBSTRING(str,start,len)</td> <td>返回从字符串 str 从 start 位置起的 len 个长度的字符串</td></tr></tbody></table> <p>演示如下：
A. concat : 字符串拼接</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> concat<span class="token punctuation">(</span><span class="token string">'Hello'</span> <span class="token punctuation">,</span> <span class="token string">' MySQL'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>B. lower/lcase : 全部转小写</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> lower<span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>C. upper/ucase : 全部转大写</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> upper<span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>D. lpad : 左填充</p> <div class="language-sql extra-class"><pre class="language-sql"><code> <span class="token keyword">select</span> lpad<span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>E. rpad : 右填充</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> rpad<span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>F. trim : 去除空格</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> trim<span class="token punctuation">(</span><span class="token string">' Hello MySQL '</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre></div><p>G. substring : 截取子字符串</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 从第一个字符开始，截取5个长度</span>
<span class="token keyword">select</span> substring<span class="token punctuation">(</span><span class="token string">'Hello MySQL'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>H. instr ： 返回第一个字符串出现的位置</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 返回结果为7,表示字符串Worl'在'Hello world'中第一次出现的位置是从第7个字符开始</span>
<span class="token keyword">select</span> instr <span class="token punctuation">(</span><span class="token string">&quot;Hello Eorld&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;World&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="数值函数"><a href="#数值函数" class="header-anchor">#</a> 数值函数</h3> <table><thead><tr><th><strong>函数</strong></th> <th><strong>功能</strong></th></tr></thead> <tbody><tr><td>CEIL(x)</td> <td>向上取整</td></tr> <tr><td>FLOOR(x)</td> <td>向下取整</td></tr> <tr><td>MOD(x,y)</td> <td>返回 x/y 的模</td></tr> <tr><td>RAND()</td> <td>返回 0~1 内的随机数</td></tr> <tr><td>ROUND(x,y)</td> <td>求参数 x 的四舍五入的值，保留 y 位小数</td></tr></tbody></table> <p>A. ceil：向上取整</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> ceil<span class="token punctuation">(</span><span class="token number">1.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>B. floor：向下取整</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> floor<span class="token punctuation">(</span><span class="token number">1.9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>C. mod：取模</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">mod</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>D. rand：获取随机数</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>E. round：四舍五入</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token number">2.344</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="日期函数"><a href="#日期函数" class="header-anchor">#</a> 日期函数</h3> <table><thead><tr><th><strong>函数</strong></th> <th><strong>功能</strong></th></tr></thead> <tbody><tr><td>CURDATE()</td> <td>返回当前日期</td></tr> <tr><td>CURTIME()</td> <td>返回当前时间</td></tr> <tr><td>NOW()</td> <td>返回当前日期和时间</td></tr> <tr><td>YEAR(date)</td> <td>获取指定 date 的年份</td></tr> <tr><td>MONTH(date)</td> <td>获取指定 date 的月份</td></tr> <tr><td>DAY(date)</td> <td>获取指定 date 的日期</td></tr> <tr><td>DATE_ADD(date, INTERVAL expr type)</td> <td>返回一个日期/时间值加上一个时间间隔 expr 后的 时间值</td></tr> <tr><td>DATEDIFF(date1,date2)</td> <td>返回起始时间 date1 和 结束时间 date2 之间的天 数</td></tr></tbody></table> <p>A. curdate：当前日期</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> curdate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>B. curtime：当前时间</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> curtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>C. now：当前日期和时间</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>D. YEAR , MONTH , DAY：当前年、月、日</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token keyword">DAY</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>E. date_add：增加指定的时间间隔<br>
date_sub：减少指定的时间间隔</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> date_add<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">interval</span> <span class="token number">70</span> <span class="token keyword">YEAR</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>F. datediff：获取两个日期相差的天数</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> datediff<span class="token punctuation">(</span><span class="token string">'2021-12-01'</span><span class="token punctuation">,</span> <span class="token string">'2021-10-01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//前面减后面</span>
</code></pre></div><h3 id="流程函数"><a href="#流程函数" class="header-anchor">#</a> 流程函数</h3> <p>流程函数也是很常用的一类函数，可以在 SQL 语句中实现条件筛选，从而提高语句的效率。</p> <table><thead><tr><th><strong>函数</strong></th> <th><strong>功能</strong></th></tr></thead> <tbody><tr><td>IF(value , t , f)</td> <td>如果 value 为 true，则返回 t，否则返回 f</td></tr> <tr><td>IFNULL(value1 , value2)</td> <td>如果 value1 不为空，返回 value1，否则 返回 value2</td></tr> <tr><td>CASE WHEN [ val1 ] THEN [res1] ... ELSE [ default ] END</td> <td>如果 val1 为 true，返回 res1，... 否 则返回 default 默认值</td></tr> <tr><td>CASE [ expr ] WHEN [ val1 ] THEN [res1] ... ELSE [ default ] END</td> <td>如果 expr 的值等于 val1，返回 res1，... 否则返回 default 默认值</td></tr></tbody></table> <p>A. if</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">'Ok'</span><span class="token punctuation">,</span> <span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>B. ifnull</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> ifnull<span class="token punctuation">(</span><span class="token string">'Ok'</span><span class="token punctuation">,</span><span class="token string">'Default'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- Ok</span>
<span class="token keyword">select</span> ifnull<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'Default'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">-- 返回空字符串</span>
<span class="token keyword">select</span> ifnull<span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'Default'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- Default</span>
</code></pre></div><p>C. case when then else end<br>
需求: 查询 emp 表的员工姓名和工作地址 (北京/上海 ----&gt; 一线城市 , 其他 ----&gt; 二线城市)</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span>
  name<span class="token punctuation">,</span>
  <span class="token punctuation">(</span> <span class="token keyword">case</span> workaddress <span class="token keyword">when</span> <span class="token string">'北京'</span> <span class="token keyword">then</span> <span class="token string">'一线城市'</span> <span class="token keyword">when</span> <span class="token string">'上海'</span> <span class="token keyword">then</span> <span class="token string">'一线城市'</span> <span class="token keyword">else</span>
<span class="token string">'二线城市'</span> <span class="token keyword">end</span> <span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">'工作地址'</span>
<span class="token keyword">from</span> emp<span class="token punctuation">;</span>

</code></pre></div><h2 id="约束"><a href="#约束" class="header-anchor">#</a> 约束</h2> <h3 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h3> <p>概念：约束是作用于表中字段上的规则，用于限制存储在表中的数据。</p> <p>目的：保证数据库中数据的正确、有效性和完整性。</p> <p>分类:</p> <table><thead><tr><th>**约束 **</th> <th>** 描述 **</th> <th>** 关键字 **</th></tr></thead> <tbody><tr><td>非空约束</td> <td>限制该字段的数据不能为 null</td> <td>NOT NULL</td></tr> <tr><td>唯一约束</td> <td>保证该字段的所有数据都是唯一、不重复的</td> <td>UNIQUE</td></tr> <tr><td>主键约束</td> <td>主键是一行数据的唯一标识，要求非空且唯一</td> <td>PRIMARY KEY</td></tr> <tr><td>默认约束</td> <td>保存数据时，如果未指定该字段的值，则采用默认值</td> <td>DEFAULT</td></tr> <tr><td>检查约束(8.0.16 版本 之后)</td> <td>保证字段值满足某一个条件</td> <td>CHECK</td></tr> <tr><td>外键约束</td> <td>用来让两张表的数据之间建立连接，保证数据的一致 性和完整性</td> <td>FOREIGN KEY</td></tr></tbody></table> <blockquote><p>注意：</p> <ul><li>约束是作用于表中字段上的，可以在创建表/修改表的时候添加约束。</li></ul></blockquote> <h3 id="约束演示"><a href="#约束演示" class="header-anchor">#</a> 约束演示</h3> <p>案例需求：
<img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692776617964-8685b628-0040-4530-a9f8-6917170472c2.png#averageHue=%23fcfcfb&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=552&amp;id=u50d2c917&amp;originHeight=552&amp;originWidth=897&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=78195&amp;status=done&amp;style=none&amp;taskId=u999f5789-5ac1-4c78-bdea-3e795fe26de&amp;title=&amp;width=897" alt="image.png"></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tb_user<span class="token punctuation">(</span>
  id 		<span class="token keyword">int</span> 				<span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> 	<span class="token keyword">COMMENT</span> <span class="token string">'ID唯一标识'</span><span class="token punctuation">,</span>
  name 	<span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">UNIQUE</span> 						<span class="token keyword">COMMENT</span> <span class="token string">'姓名'</span> <span class="token punctuation">,</span>
  age 	<span class="token keyword">int</span> 				<span class="token keyword">check</span> <span class="token punctuation">(</span>age <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> age <span class="token operator">&lt;=</span> <span class="token number">120</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'年龄'</span> <span class="token punctuation">,</span>
  <span class="token keyword">status</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> 		<span class="token keyword">default</span> <span class="token string">'1'</span> 								<span class="token keyword">COMMENT</span> <span class="token string">'状态'</span><span class="token punctuation">,</span>
  gender <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> 																<span class="token keyword">COMMENT</span> <span class="token string">'性别'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="外键约束"><a href="#外键约束" class="header-anchor">#</a> 外键约束</h3> <p>介绍
外键：用来让两张表的数据之间建立连接，从而保证数据的一致性和完整性。</p> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692776817836-0c85afc4-53f5-45cf-8b39-af2bcf1b9c7d.png#averageHue=%23faf9f9&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=202&amp;id=ua9cb695c&amp;originHeight=202&amp;originWidth=904&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=68921&amp;status=done&amp;style=none&amp;taskId=u076dc1c3-d0cb-4493-8374-d69bf1ba4ab&amp;title=&amp;width=904" alt="image.png"></p> <blockquote><p>注意：</p> <ul><li>目前上述两张表，只是在逻辑上存在这样一层关系；在数据库层面，并未建立外键关联， 所以是无法保证数据的一致性和完整性的。</li></ul></blockquote> <p>此时， 删除 id 为 1 的部门信息<br>
结果，我们看到删除成功，而删除成功之后，部门表不存在 id 为 1 的部门，而在 emp 表中还有很多的员 工，关联的为 id 为 1 的部门，此时就出现了数据的不完整性。 而要想解决这个问题就得通过数据库的 外键约束。</p> <p>语法：
添加外键</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> 表名<span class="token punctuation">(</span>
  字段名 数据类型<span class="token punctuation">,</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token punctuation">[</span><span class="token keyword">constraint</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>外键名称<span class="token punctuation">]</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>外键字段名<span class="token punctuation">)</span> <span class="token keyword">references</span> 主表 <span class="token punctuation">(</span>主表列名<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名
<span class="token keyword">add</span> <span class="token keyword">constraint</span> 外键名称
<span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>外键字段名<span class="token punctuation">)</span>
<span class="token keyword">references</span> 主表 <span class="token punctuation">(</span>主表列名<span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre></div><p>案例：
为 emp 表的 dept_id 字段添加外键约束,关联 dept 表的主键 id。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> emp
<span class="token keyword">add</span> <span class="token keyword">constraint</span> fk_emp_dept_id
<span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span>
<span class="token keyword">references</span> dept<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>添加了外键约束之后，我们再到 dept 表(父表)删除 id 为 1 的记录。
此时 将会报错，不能删除或更新父表记录，因为存在外键约束。</p> <p>删除外键</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名 <span class="token keyword">drop</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span> 外键名称<span class="token punctuation">;</span>
</code></pre></div><h3 id="删除-更新行为"><a href="#删除-更新行为" class="header-anchor">#</a> 删除/更新行为</h3> <p>添加了外键之后，再删除父表数据时产生的约束行为，我们就称为删除/更新行为。具体的删除/更新行 为有以下几种:<br> <img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692779845390-5dc069db-bebe-4923-8a46-21058cd4904c.png#averageHue=%23fbfbfa&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=599&amp;id=u74207d19&amp;originHeight=599&amp;originWidth=906&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=172921&amp;status=done&amp;style=none&amp;taskId=u5d228623-2dab-4274-9042-8803b290644&amp;title=&amp;width=906" alt="image.png"></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名 <span class="token keyword">add</span> <span class="token keyword">constraint</span> 外键名称 <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>外键字段<span class="token punctuation">)</span>
<span class="token keyword">references</span> 主表名 <span class="token punctuation">(</span>主表字段名<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">cascade</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">cascade</span>
</code></pre></div><p>1). CASCADE</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> emp <span class="token keyword">add</span> <span class="token keyword">constraint</span> fk_emp_dept_id <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">references</span>
dept<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">cascade</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">cascade</span> <span class="token punctuation">;</span>
</code></pre></div><p>2). SET NULL</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> emp <span class="token keyword">add</span> <span class="token keyword">constraint</span> fk_emp_dept_id <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">references</span>
dept<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">set</span> <span class="token boolean">null</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">set</span> <span class="token boolean">null</span> <span class="token punctuation">;</span>
</code></pre></div><h2 id="多表联查"><a href="#多表联查" class="header-anchor">#</a> 多表联查</h2> <h3 id="分类"><a href="#分类" class="header-anchor">#</a> 分类</h3> <p>连接查询</p> <p>内连接：相当于查询 A、B 交集部分数据
外连接：
左外连接：查询左表所有数据，以及两张表交集部分数据
右外连接：查询右表所有数据，以及两张表交集部分数据
自连接：当前表与自身的连接查询，自连接必须使用表别名</p> <p>子查询</p> <h3 id="内连接"><a href="#内连接" class="header-anchor">#</a> 内连接</h3> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692784565485-0902b548-926a-430b-871b-ca69629037b3.png#averageHue=%23f9f9ed&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=314&amp;id=u06d78dae&amp;originHeight=314&amp;originWidth=930&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=72886&amp;status=done&amp;style=none&amp;taskId=u7c1b9d8d-5c58-41f2-9de0-57b116b8fd2&amp;title=&amp;width=930" alt="image.png"></p> <p>1). 隐式内连接</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> 字段列表 <span class="token keyword">from</span> 表<span class="token number">1</span> <span class="token punctuation">,</span> 表<span class="token number">2</span> <span class="token keyword">where</span> 条件 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">;</span>
</code></pre></div><p>2). 显式内连接</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> 字段列表 <span class="token keyword">from</span> 表<span class="token number">1</span> <span class="token punctuation">[</span> <span class="token keyword">inner</span> <span class="token punctuation">]</span> <span class="token keyword">join</span> 表<span class="token number">2</span> <span class="token keyword">on</span> 连接条件 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">;</span>
</code></pre></div><h3 id="外连接"><a href="#外连接" class="header-anchor">#</a> 外连接</h3> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692784803216-a54ee5a3-7218-41f8-9728-9397aaef562f.png#averageHue=%23e0e098&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=245&amp;id=uf55ec889&amp;originHeight=245&amp;originWidth=661&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=47189&amp;status=done&amp;style=none&amp;taskId=u4cdb8016-34e4-4223-a2d2-80d5f7a06cd&amp;title=&amp;width=661" alt="image.png"></p> <p>1). 左外连接</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> 字段列表 <span class="token keyword">from</span> 表<span class="token number">1</span> <span class="token keyword">left</span> <span class="token punctuation">[</span> <span class="token keyword">outer</span> <span class="token punctuation">]</span> <span class="token keyword">join</span> 表<span class="token number">2</span> <span class="token keyword">on</span> 条件 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">;</span>
</code></pre></div><p>左外连接相当于查询表 1(左表)的所有数据，当然也包含表 1 和表 2 交集部分的数据。</p> <p>2). 右外连接</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> 字段列表 <span class="token keyword">from</span> 表<span class="token number">1</span> <span class="token keyword">right</span> <span class="token punctuation">[</span> <span class="token keyword">outer</span> <span class="token punctuation">]</span> <span class="token keyword">join</span> 表<span class="token number">2</span> <span class="token keyword">on</span> 条件 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>右外连接相当于查询表 2(右表)的所有数据，当然也包含表 1 和表 2 交集部分的数据。</p> <blockquote><p>注意事项：</p> <ul><li>左外连接和右外连接是可以相互替换的，只需要调整在连接查询时 SQL 中，表结构的先后顺 序就可以了。而我们在日常开发使用时，更偏向于左外连接。</li></ul></blockquote> <h3 id="自连接"><a href="#自连接" class="header-anchor">#</a> 自连接</h3> <h4 id="自连接查询"><a href="#自连接查询" class="header-anchor">#</a> 自连接查询</h4> <p>自连接查询，顾名思义，就是自己连接自己，也就是把一张表连接查询多次。我们先来学习一下自连接 的查询语法：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> 字段列表 <span class="token keyword">from</span> 表A 别名A <span class="token keyword">join</span> 表A 别名B <span class="token keyword">on</span> 条件 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>而对于自连接查询，可以是内连接查询，也可以是外连接查询。</p> <blockquote><p>注意事项:
在自连接查询中，必须要为表起别名，要不然我们不清楚所指定的条件、返回的字段，到底 是哪一张表的字段。</p></blockquote> <h4 id="联合查询"><a href="#联合查询" class="header-anchor">#</a> 联合查询</h4> <p>对于 union 查询，就是把多次查询的结果合并起来，形成一个新的查询结果集。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> 字段列表 <span class="token keyword">from</span> 表A <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">union</span> <span class="token punctuation">[</span> <span class="token keyword">ALL</span> <span class="token punctuation">]</span>
<span class="token keyword">select</span> 字段列表 <span class="token keyword">from</span> 表B <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>对于联合查询的多张表的<strong>列数</strong>必须保持一致，<strong>字段类型</strong>也需要保持一致。</li> <li>union [ all ] 会将全部的数据直接合并在一起，union 会对合并之后的数据去重。</li></ul> <h3 id="子查询"><a href="#子查询" class="header-anchor">#</a> 子查询</h3> <h4 id="概述-2"><a href="#概述-2" class="header-anchor">#</a> 概述</h4> <p>1). 概念
SQL 语句中嵌套 SELECT 语句，称为嵌套查询，又称子查询。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> t1 <span class="token keyword">WHERE</span> column1 <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token keyword">SELECT</span> column1 <span class="token keyword">FROM</span> t2 <span class="token punctuation">)</span>
</code></pre></div><p>子查询外部的语句可以是 INSERT / UPDATE / DELETE / SELECT 的任何一个。</p> <p>2). 分类
根据子查询结果不同，分为：
A. 标量子查询（子查询结果为单个值）
B. 列子查询(子查询结果为一列)
C. 行子查询(子查询结果为一行)
D. 表子查询(子查询结果为多行多列)</p> <p>根据子查询位置，分为：
A. WHERE 之后
B. FROM 之后
C. SELECT 之后</p> <h4 id="标量子查询"><a href="#标量子查询" class="header-anchor">#</a> 标量子查询</h4> <p>子查询返回的结果是单个值（数字、字符串、日期等），最简单的形式，这种子查询称为标量子查询。 常用的操作符：= &lt;&gt; &gt; &gt;= &lt; &lt;=</p> <h4 id="列子查询"><a href="#列子查询" class="header-anchor">#</a> 列子查询</h4> <p>子查询返回的结果是一列（可以是多行），这种子查询称为列子查询。 常用的操作符：IN 、NOT IN 、 ANY 、SOME 、 ALL<br> <img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692785478091-1ee6038c-ca58-42fe-a451-7d73f4d3360c.png#averageHue=%23fcfbfb&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=381&amp;id=u8dfab641&amp;originHeight=381&amp;originWidth=906&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=60021&amp;status=done&amp;style=none&amp;taskId=u84a121b8-de1c-4276-85a4-800bd71f306&amp;title=&amp;width=906" alt="image.png"></p> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692785625092-49bdd806-7b2d-4c45-9e75-32c528689cac.png#averageHue=%23e1cfb7&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=473&amp;id=u3c3a6f1b&amp;originHeight=473&amp;originWidth=925&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=62104&amp;status=done&amp;style=none&amp;taskId=u3f58ad4c-6a4a-4bf6-91f2-6ee88e8a9e7&amp;title=&amp;width=925" alt="image.png"></p> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692785634255-e3781f4e-6552-4328-a65e-ac8675137d63.png#averageHue=%23e2d3bb&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=619&amp;id=ueef4567d&amp;originHeight=619&amp;originWidth=914&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=77566&amp;status=done&amp;style=none&amp;taskId=ufbddcaf4-767d-4e14-9b0b-a92ba33ff0a&amp;title=&amp;width=914" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692785682962-400e5c62-69fa-43d1-aaa9-c09ec5a6d5fd.png#averageHue=%23e2d3ba&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=410&amp;id=u5a76b398&amp;originHeight=410&amp;originWidth=922&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=67987&amp;status=done&amp;style=none&amp;taskId=u0f023e20-3fdb-4277-b3dc-3661b21e373&amp;title=&amp;width=922" alt="image.png"></p> <h4 id="行子查询"><a href="#行子查询" class="header-anchor">#</a> 行子查询</h4> <p>子查询返回的结果是一行（可以是多列），这种子查询称为行子查询。 常用的操作符：= 、&lt;&gt; 、IN 、NOT IN</p> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692785737579-c448b720-4860-4e7f-a8cc-1f4056ed6c68.png#averageHue=%23fcfcfb&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=620&amp;id=ud66a376f&amp;originHeight=620&amp;originWidth=924&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=80390&amp;status=done&amp;style=none&amp;taskId=ud1c1c954-e49a-4ab9-a8aa-9049e5d0d70&amp;title=&amp;width=924" alt="image.png"></p> <h4 id="表子查询"><a href="#表子查询" class="header-anchor">#</a> 表子查询</h4> <p>子查询返回的结果是多行多列，这种子查询称为表子查询。 常用的操作符：IN<br> <img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692785768559-373e14ad-acd8-4a5a-9e29-167c6a2ff827.png#averageHue=%23e2cfb7&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=479&amp;id=u700f38df&amp;originHeight=479&amp;originWidth=914&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=85389&amp;status=done&amp;style=none&amp;taskId=u006905d8-b38d-414d-82fa-77844c7e202&amp;title=&amp;width=914" alt="image.png"></p> <h2 id="事务"><a href="#事务" class="header-anchor">#</a> 事务</h2> <h3 id="事务简介"><a href="#事务简介" class="header-anchor">#</a> 事务简介</h3> <p>事务 是一组操作的集合，它是一个不可分割的工作单位，事务会把所有的操作作为一个整体一起向系 统提交或撤销操作请求，即这些操作要么同时成功，要么同时失败。</p> <h3 id="事务操作"><a href="#事务操作" class="header-anchor">#</a> 事务操作</h3> <h4 id="控制事务一"><a href="#控制事务一" class="header-anchor">#</a> 控制事务一</h4> <p>1). 查看/设置事务提交方式</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> @<span class="token variable">@autocommit</span> <span class="token punctuation">;</span>
<span class="token keyword">SET</span> @<span class="token variable">@autocommit</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>
</code></pre></div><p>2). 提交事务</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">commit</span><span class="token punctuation">;</span>
</code></pre></div><p>3). 回滚事务</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">rollback</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>注意：
上述的这种方式，我们是修改了事务的自动提交行为, 把默认的自动提交修改为了手动提 交, 此时我们执行的 DML 语句都不会提交, 需要手动的执行 commit 进行提交。</p></blockquote> <h4 id="控制事务二"><a href="#控制事务二" class="header-anchor">#</a> 控制事务二</h4> <p>1). 开启事务</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">start</span> <span class="token keyword">transaction</span> 或 <span class="token keyword">begin</span> <span class="token punctuation">;</span>
</code></pre></div><p>2). 提交事务</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">commit</span><span class="token punctuation">;</span>
</code></pre></div><p>3). 回滚事务</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">rollback</span><span class="token punctuation">;</span>
</code></pre></div><p>转账案例：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 开启事务</span>
<span class="token keyword">start</span> <span class="token keyword">transaction</span>

<span class="token comment">-- 1. 查询张三余额</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>

<span class="token comment">-- 2. 张三的余额减少1000</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">-</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>

<span class="token comment">-- 3. 李四的余额增加1000</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">+</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'李四'</span><span class="token punctuation">;</span>

<span class="token comment">-- 如果正常执行完毕, 则提交事务</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>

<span class="token comment">-- 如果执行过程中报错, 则回滚事务</span>
<span class="token comment">-- rollback;</span>
</code></pre></div><h3 id="事务四大特性"><a href="#事务四大特性" class="header-anchor">#</a> 事务四大特性</h3> <ul><li>原子性（Atomicity）：事务是不可分割的最小操作单元，要么全部成功，要么全部失败。</li> <li>一致性（Consistency）：事务完成时，必须使所有的数据都保持一致状态。</li> <li>隔离性（Isolation）：数据库系统提供的隔离机制，保证事务在不受外部并发操作影响的独立 环境下运行。</li> <li>持久性（Durability）：事务一旦提交或回滚，它对数据库中的数据的改变就是永久的。</li></ul> <p>上述就是事务的四大特性，简称 ACID。</p> <h3 id="并发事务问题"><a href="#并发事务问题" class="header-anchor">#</a> 并发事务问题</h3> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692786258185-929861b9-8317-4d17-8ab4-5dbd1f954084.png#averageHue=%23fcf8f5&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=361&amp;id=u5a45b074&amp;originHeight=361&amp;originWidth=904&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=67613&amp;status=done&amp;style=none&amp;taskId=u7bdb5cb9-5ac5-43c5-9c68-0fb0ec56fcd&amp;title=&amp;width=904" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692786269806-4bc0c3b9-993c-49cb-8a09-1951bf27e9a2.png#averageHue=%23fcf8f5&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=348&amp;id=ubae83f57&amp;originHeight=348&amp;originWidth=924&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=76947&amp;status=done&amp;style=none&amp;taskId=u4c959b3b-2492-4378-92fe-816dc2bbe6b&amp;title=&amp;width=924" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692786285471-e844a07f-1d37-4509-9754-c2728d450cbb.png#averageHue=%23fcf8f5&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=313&amp;id=u32bc5db6&amp;originHeight=313&amp;originWidth=930&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=70649&amp;status=done&amp;style=none&amp;taskId=u7c5f6d85-25b1-4339-97d6-4471f024686&amp;title=&amp;width=930" alt="image.png"></p> <h3 id="事务隔离级别"><a href="#事务隔离级别" class="header-anchor">#</a> 事务隔离级别</h3> <p>为了解决并发事务所引发的问题，在数据库中引入了事务隔离级别。主要有以下几种：<br> <img src="https://cdn.nlark.com/yuque/0/2023/png/33678031/1692786328196-08c4f44f-bae1-455a-8c33-274f7b73f61f.png#averageHue=%23fcfbfb&amp;clientId=u69ba1454-6681-4&amp;from=paste&amp;height=319&amp;id=u1d637c7c&amp;originHeight=319&amp;originWidth=902&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=33315&amp;status=done&amp;style=none&amp;taskId=uf6b0b90a-6136-43db-b900-ff078333a03&amp;title=&amp;width=902" alt="image.png"></p> <p>1). 查看事务隔离级别</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> @<span class="token variable">@TRANSACTION_ISOLATION</span><span class="token punctuation">;</span>
</code></pre></div><p>2). 设置事务隔离级别</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token punctuation">[</span> <span class="token keyword">session</span> <span class="token operator">|</span> <span class="token keyword">global</span> <span class="token punctuation">]</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span>
{ <span class="token keyword">read</span> <span class="token keyword">uncommitted</span> <span class="token operator">|</span> <span class="token keyword">read</span> <span class="token keyword">committed</span> <span class="token operator">|</span> <span class="token keyword">repeatable</span> <span class="token keyword">read</span> <span class="token operator">|</span> <span class="token keyword">serializable</span> }
</code></pre></div><blockquote><p>注意：
事务隔离级别越高，数据越安全，但是性能越低。</p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/document/assets/js/app.407b5965.js" defer></script><script src="/document/assets/js/2.3dc1b8de.js" defer></script><script src="/document/assets/js/1.54be531d.js" defer></script><script src="/document/assets/js/23.cbb9b3bb.js" defer></script>
  </body>
</html>
